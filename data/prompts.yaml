anomaly_detection:
  analyze_log: 'Analyse ce log d''audit Oracle 21c. Est-il suspect ?


    Log : {log}

    Contexte : {context}

    Heure : {time}

    Utilisateur : {user}


    Évalue selon :

    1. Timing (heures normales de travail ?)

    2. Utilisateur (habituel pour cette action ?)

    3. Action (conforme aux rôles ?)

    4. Objet cible (sensible ?)

    5. IP (connue ?)


    Classe en : NORMAL / SUSPECT / CRITIQUE

    Justifie ta réponse avec des indicateurs.'
  detect_intrusion: 'Détecte les patterns d''attaque dans cette séquence de logs Oracle
    21c.

    Recherche : injection SQL, escalade privilèges, exfiltration données, accès hors
    heure.


    Logs : {logs}

    Période : {period}

    Utilisateurs concernés : {users}


    Identifie :

    1. Type d''attaque potentielle

    2. Sévérité (CRITIQUE/HAUTE/MOYENNE)

    3. Indicateurs de compromission

    4. Recommandation immédiate

    5. Investigation à mener'
  sequence_analysis: 'Analyse cette séquence temporelle de logs Oracle.


    Séquence : {sequence}

    Fenêtre temporelle : {window}


    Recherche :

    - Activité anormale groupée

    - Tentatives répétées

    - Patterns d''attaque

    - Comportements inhabituels


    Fournis : timeline des événements, corrélations, risque global.'
backup_strategy:
  recommend_plan: "Recommande une stratégie de sauvegarde Oracle 21c XE optimale.\n\
    \nContexte Oracle 21c XE :\n- Taille DB : {size} GB (limite XE: 12GB)\n- RPO requis\
    \ : {rpo}\n- RTO requis : {rto}\n- Criticité : {criticality}\n- Espace disponible\
    \ : {space}\n- Archive mode : {archive_mode}\n\nFournis en JSON :\n{\n  \"type_backup\"\
    : [\"complète\", \"incrémentielle\", \"archivelog\"],\n  \"frequence\": {\"full\"\
    : \"X\", \"incremental\": \"Y\", \"archivelog\": \"Z\"},\n  \"retention\": {\"\
    days\": N, \"recovery_window\": M},\n  \"emplacement\": [\"local\", \"cloud\"\
    , \"nfs\"],\n  \"outil\": [\"RMAN\", \"Data Pump\", \"Cloud Backup\"],\n  \"commande_exemple\"\
    : \"commande RMAN\",\n  \"coût_estimé\": \"$\",\n  \"limitations_XE\": [\"...\"\
    ]\n}"
  validate_rman_script: 'Valide ce script RMAN Oracle 21c.


    Script : {script}

    Configuration : {config}


    Vérifie :

    1. Syntaxe correcte

    2. Compatibilité Oracle 21c XE

    3. Bonnes pratiques

    4. Gestion des erreurs

    5. Plan de restauration


    Corrige si nécessaire.'
general_dba:
  capacity_planning: 'Planification de capacité Oracle 21c XE.


    Utilisation actuelle : {current_usage}

    Croissance prévue : {growth}

    Objectifs : {objectives}

    Contraintes XE : {xe_constraints}


    Fournis recommandations :

    1. Projections 3/6/12 mois

    2. Points de rupture

    3. Actions préventives

    4. Migration planning'
  troubleshoot_performance: 'Diagnostique ce problème de performance Oracle 21c.


    Symptômes : {symptoms}

    Métriques : {metrics}

    Alertes : {alerts}

    Récent changements : {changes}


    Fournis diagnostic par étapes :

    1. Investigations immédiates

    2. Commandes à exécuter

    3. Interprétation des résultats

    4. Correctifs possibles

    5. Monitoring post-correction'
query_optimization:
  explain_plan: "Explique ce plan d'exécution Oracle 21c en termes simples.\nIdentifie\
    \ les 3 opérations les plus coûteuses et leurs impacts.\n\nPlan : {plan}\nRequête\
    \ : {query}\nStatistiques : {stats}\n\nFormat : \n1. Explication claire du flux\n\
    2. Points coûteux numérotés avec % d'impact\n3. Suggestions de réduction de coût"
  index_recommendation: 'Recommande des index pour améliorer cette requête Oracle
    21c.


    Requête : {query}

    Tables concernées : {tables}

    Colonnes filtrées/jointees : {columns}

    Volume de données : {volume}


    Fournis :

    - Index recommandés (colonne, type)

    - Impact estimé

    - Énoncé CREATE INDEX

    - Considérations (maintien, espace)'
  suggest_optimization: 'Propose 2-3 optimisations concrètes pour cette requête Oracle
    21c.


    Requête : {query}

    Temps d''exécution : {time}s

    Coût optimiseur : {cost}

    Problème détecté : {issue}

    Métriques : {metrics}


    Fournis :

    1. Recommandation 1 (prioritaire) avec code SQL

    2. Recommandation 2 (alternative)

    3. Recommandation 3 (architecturale si nécessaire)

    4. Impact estimé sur performance'
recovery_guide:
  generate_playbook: 'Génère un playbook RMAN détaillé pour Oracle 21c XE.


    Scénario : {scenario}

    Backup disponible : {backup_status}

    Date cible : {target_date}

    PDB/Non-CDB : {pdb_status}

    Espace disponible : {space}


    Fournis :

    1. Étapes numérotées avec vérifications

    2. Commandes RMAN exactes (Oracle 21c)

    3. Points de validation à chaque étape

    4. Durée estimée par étape

    5. Rollback plan en cas d''échec

    6. Post-recovery validation'
  point_in_time_recovery: 'Guide de récupération point-in-time Oracle 21c.


    Date/heure cible : {target_datetime}

    Type de perte : {loss_type}

    Objets affectés : {affected_objects}

    Backups disponibles : {available_backups}


    Fournis playbook avec :

    1. Pré-requis et vérifications

    2. Commandes RMAN exactes

    3. Vérification des SCN/Time

    4. Procédure de switchover

    5. Validation post-récupération'
security_audit:
  analyze_users: 'Analyse cette configuration utilisateurs Oracle 21c.

    Identifie les risques de sécurité selon ces critères :

    - Privilèges excessifs (DBA, SYSDBA, SYSOPER)

    - Comptes par défaut non sécurisés

    - Rôles cumulés dangereux

    - Comptes expirés mais actifs

    - Profils non sécurisés

    - Tablespace SYSTEM utilisé par des utilisateurs applicatifs


    Configuration : {config}


    Fournis : score/100, risques détectés (CRITIQUE/HAUTE/MOYENNE/FAIBLE), recommandations.'
  assess_privileges: "Évalue ces privilèges système Oracle 21c.\nVérifie : moindre\
    \ privilège, séparation des responsabilités, accès sensibles.\n\nPrivilèges :\
    \ {privileges}\nUtilisateurs : {users}\n\nFormat : \n- Sévérité (CRITIQUE/HAUTE/MOYENNE/FAIBLE)\n\
    - Justification détaillée\n- Correction immédiate\n- Action à long terme"
  check_audit_policies: 'Vérifie les politiques d''audit unifié Oracle 21c.

    Politiques : {policies}


    Évalue : couverture d''audit, événements critiques audités, lacunes.'
